[INFO] Language to train OCR for is igbo
[INFO] Model Parameters are : {'batch_size': 32, 'eng_charset': '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&\'"()*+,-./:;<=>?@[]^_`{|}~\\ ', 'yor_charset': '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&\'"()*+,-./:;<=>?@[]^_`{|}~\\ ', 'igbo_charset': '!"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~̣ṄṅẁỊịỌọỤụ ', 'target_path': 'run/checkpoint_weights_eng_trdg.pt', 'source': 'raw_data/trdg', 'lr': 1e-05, 'num_epochs': 500, 'eng_max_text_len': 128, 'igbo_max_text_len': 200}
[INFO] Model Parameters are : {'batch_size': 32, 'eng_charset': '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&\'"()*+,-./:;<=>?@[]^_`{|}~\\ ', 'yor_charset': '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&\'"()*+,-./:;<=>?@[]^_`{|}~\\ ', 'igbo_charset': '!"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~̣ṄṅẁỊịỌọỤụ ', 'target_path': 'run/checkpoint_weights_eng_trdg.pt', 'source': 'raw_data/trdg', 'lr': 1e-05, 'num_epochs': 500, 'eng_max_text_len': 128, 'igbo_max_text_len': 200}
[INFO] Generating Dataset Loader
[INFO] Length of training dataset is 3017
[INFO] Length of validation dataset is 336
[INFO] Load pretrained model
[INFO] Training Begin ......
Epoch: 01 learning rate[1e-05]
/scratch/odunayo/multilingual-ocr/venv/lib/python3.7/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
terminate called after throwing an instance of 'c10::CUDAOutOfMemoryError'
  what():  CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 14.76 GiB total capacity; 13.05 GiB already allocated; 3.75 MiB free; 13.58 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Exception raised from malloc at /tmp/coulombc/pytorch_build_2021-11-09_14-57-01/avx2/python3.7/pytorch/c10/cuda/CUDACachingAllocator.cpp:513 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x55 (0x2b2c593ed905 in /scratch/odunayo/multilingual-ocr/venv/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x295bf (0x2b2c5938f5bf in /scratch/odunayo/multilingual-ocr/venv/lib/python3.7/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x2a2c5 (0x2b2c593902c5 in /scratch/odunayo/multilingual-ocr/venv/lib/python3.7/site-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x2a7d2 (0x2b2c593907d2 in /scratch/odunayo/multilingual-ocr/venv/lib/python3.7/site-packages/torch/lib/libc10_cuda.so)
frame #4: THCStorage_resizeBytes(THCState*, c10::StorageImpl*, long) + 0x84 (0x2b2c403891f4 in /scratch/odunayo/multilingual-ocr/venv/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0x1c9e2c1 (0x2b2c3ed462c1 in /scratch/odunayo/multilingual-ocr/venv/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #6: at::native::empty_strided_cuda(c10::ArrayRef<long>, c10::ArrayRef<long>, c10::optional<c10::ScalarType>, c10::optional<c10::Layout>, c10::optional<c10::Device>, c10::optional<bool>) + 0x66 (0x2b2c400d3ca6 in /scratch/odunayo/multilingual-ocr/venv/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x317785a (0x2b2c4021f85a in /scratch/odunayo/multilingual-ocr/venv/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #8: <unknown function> + 0x31778d0 (0x2b2c4021f8d0 in /scratch/odunayo/multilingual-ocr/venv/lib/python3.7/site-packages/torch/lib/libtorch_cuda.so)
frame #9: <unknown function> + 0x1e56e88 (0x2b2c34945e88 in /scratch/odunayo/multilingual-ocr/venv/lib/python3.7/site-packages/torch/lib/libtorch_cpu.so)

/var/spool/slurmd/job54953485/slurm_script: line 19: 174767 Aborted                 (core dumped) nohup python3 main.py --lang igbo
